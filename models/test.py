from keras.models import load_model
import numpy as np
import pandas as pd
import random as r
import matplotlib.pyplot as plt

from sklearn.metrics import roc_curve, auc, confusion_matrix
from scipy import interp
from train import find_subject_ids, load_dataframe, split
from train import load_dataframe

def validate_model():
    auc_tot = []
    eer_tot = []
    subject_ids = find_subject_ids("models/min_300/")
    for subject_id in subject_ids:
        subject = subject_id.split('_')[0]
        print(subject)
        neg = subject_ids[r.randint(0, len(subject_ids)-1)]
        neg_subject = neg.split('_')[0]
        if(neg_subject == subject):
            neg = subject_ids[r.randint(0, len(subject_ids)-1)]
            neg_subject = neg.split('_')[0]

        df_pos = load_dataframe(subject, "val")
        df_neg = load_dataframe(neg_subject, "val")

        df = np.concatenate([df_pos, df_neg], axis=0)

        X, y = split(subject, df)

        model_path = "models/min_300/"+subject_id+".h5"
        model = load_model(model_path)

        y_pred = model.predict_proba(X)
        y_pred_max = y_pred.argmax(axis=1)
        y_pred = y_pred[:,1]

        cm = confusion_matrix(y, y_pred_max)
        #print(cm)

        fpr, tpr, thresholds = roc_curve(y, y_pred)
        roc_auc = auc(fpr, tpr)
        print("AUC: ", roc_auc)

        plot = False
        if plot:
            plt.figure()
            plt.plot(fpr, tpr, color='r')
            plt.xlim([0.0, 1.0])
            plt.ylim([0.0, 1.0])
            plt.show()

        fnr = 1-tpr
        EER = fpr[np.nanargmin(np.absolute(fnr-fpr))]
        eer_tot.append(EER)
        print(eer_tot)
        auc_tot.append(roc_auc)
        print("AUC", auc_tot)


def evaluate_performance():
    eer_100 = [0.28512396694214875, 0.16205910390848427, 0.22587268993839835, 0.2892459826946848, 0.22752808988764045, 0.1618229854689564, 0.2957497048406139, 0.25119236883942764, 0.21490467937608318, 0.08784676354029063, 0.5, 0.27009646302250806, 0.08894536213468869, 0.28026692087702576, 0.2632066728452271, 0.4960369881109643, 0.020274689339437543, 0.15715093273035613, 0.42257001647446457, 0.31787389265242316, 0.22018348623853212, 0.16634429400386846, 0.3910472972972973, 0.014986376021798364, 0.18872266973532797, 0.20767778477029578, 0.0009394081728511038, 0.21083172147001933, 0.27030033370411566, 0.12510425354462051, 0.1682408500590319, 0.03114571746384872, 0.453382084095064, 0.22812051649928264, 0.0967741935483871, 0.2668481960517359, 0.17145270270270271, 0.4806312769010043, 0.37258347978910367, 0.18568665377176016, 0.29525483304042177, 0.3811213626685593, 0.19440459110473457, 0.2987111448066717, 0.3938832252085264, 0.34966216216216217, 0.4722589167767503, 0.20667284522706209, 0.44256756756756754, 0.23228995057660626, 0.0785472972972973, 0.44592696629213485, 0.20607661822985468, 0.19283065512978986, 0.11724856696195936, 0.27961019490254874, 0.4794661190965092, 0.4184514003294893, 0.04920767306088407, 0.4152276295133438, 0.36731107205623903, 0.5498392282958199, 0.34063745019920316, 0.21841240018788163, 0.4303466317854807, 0.13568215892053972, 0.4634760705289673, 0.3430451127819549, 0.22086466165413535, 0.10543657331136738, 0.027111574556830033, 0.14676966292134833, 0.5818561001042752, 0.1762252346193952, 0.3437152391546162, 0.15943962641761175, 0.2871587462082912, 0.2647058823529412, 0.0950792326939116, 0.05337519623233909, 0.19095092024539878, 0.6770759403832506, 0.29822732012513037, 0.329700272479564, 0.2640170333569908, 0.5297225891677675, 0.013711151736745886, 0.24271844660194175, 0.2841845140032949, 0.07463672391017173, 0.07494866529774127, 0.44026682838083686, 0.24174372523117568, 0.43363446838082004, 0.3822042467138524]
    auc_scores_100_3 = [0.7779645304661982, 0.9133706891505033, 0.8368977912805503, 0.7515891163234524, 0.8371084665775059, 0.9138429014488868, 0.7909156407943435, 0.8187201700673792, 0.902966072010551, 0.9670696518344767, 0.48804897363348404, 0.8096786653860608, 0.9764165194149406, 0.7710666600384825, 0.7779380549493259, 0.48951504741936047, 0.9934301473004612, 0.8901922879206643, 0.6718639156460511, 0.7533418232637619, 0.8833529238770537, 0.9186816223290388, 0.7231439587529687, 0.9965796543489575, 0.8754040995599699, 0.8510418194637003, 0.9999398133469177, 0.8588039362777405, 0.8381395188722479, 0.9134414850887439, 0.883787513888349, 0.9907652360557021, 0.5910885245563635, 0.7871368920048197, 0.9384180472465629, 0.7963127933962914, 0.9150106279390111, 0.5588515251200467, 0.6551849481174111, 0.8754688929935067, 0.7756305118318967, 0.6790550042772847, 0.8629057568149212, 0.7522573241484835, 0.6450331377451433, 0.7464747509185582, 0.5834541784821444, 0.8705653849655549, 0.5796440429861831, 0.8227374618521619, 0.93848286503396, 0.6024750756029799, 0.8729098557771187, 0.8708150086320369, 0.9541307669346393, 0.790715865525276, 0.5820102852043865, 0.6764051094412564, 0.9897600470351906, 0.6354759620233849, 0.6996732166225829, 0.4422189229031858, 0.721481082158853, 0.842905873787431, 0.5796408944419947, 0.9346058339017365, 0.588583100073792, 0.7260291322034238, 0.85889636570834, 0.969761565519391, 0.9896140152632431, 0.9021086161548578, 0.4180234671757255, 0.8897972678732979, 0.7255404136697237, 0.9197217225882517, 0.7891809908998988, 0.8240726217551564, 0.9528157730677046, 0.9783515769583769, 0.8881295166783354, 0.3321870264515757, 0.7660952660004703, 0.7061371617898947, 0.7939631719640696, 0.511008890923201, 0.9998313400335513, 0.8184899515748063, 0.8072829465833249, 0.9818491634794277, 0.962652062285164, 0.6114087397750368, 0.8206725963083294, 0.6121908607312603, 0.6974774288288338]
    auc_scores_100 = [0.777696409134912, 0.7224622421846867, 0.7569679478065346, 0.5686239257847614, 0.7595463404371866, 0.9745092372866734, 0.6767615439644356, 0.8897969430333078, 0.8735413664873042, 0.9271110669699641, 0.6256166485824385, 0.7685828698012391, 0.9671567747190987, 0.6861654906696275, 0.7959703718194553, 0.6290985434705032, 0.9953920719896463, 0.8201322881181436, 0.820164827188788, 0.7470569005068914, 0.7401730150617803, 0.8546952669900396, 0.92852306168086, 0.7614477287155521, 0.991045622192242, 0.7630750216028842, 0.988609739427515, 0.7064667471421301, 0.9248756135640389, 0.7696004887207913, 0.8211911587812161, 0.9666431410558645, 0.9018611245173745, 0.8075621840450319, 0.9124474837419064, 0.7541111157530628, 0.8936209946638949, 0.619861495553724, 0.6714530341762485, 0.7545134879309381, 0.8138512760571522, 0.7287869520492177, 0.956449877876187, 0.7104225387496415, 0.8046397502294251, 0.8495660384107248, 0.7703702159869569, 0.9572862771461639, 0.569919541354036, 0.7913396710890074, 0.7498833763240218, 0.9988389024678073, 0.9297087126601474, 0.9042417191735777, 0.9854103589663379, 0.7385960088960476, 0.5827879777808304, 0.9069203565001883, 0.7745389101060701, 0.6053869822859925, 0.6794943973266985, 0.8657759445573928, 0.7293574921011797, 0.8299105667866586, 0.524242511025832, 0.9189905279194542, 0.9733770003006714, 0.6521254357034743, 0.8044818505999245, 0.7578669277138199, 0.9054334264366024, 0.4814827035684281, 0.7475200061427903, 0.9502891012679698, 0.7635802982390953, 0.9358602291720436, 0.9435979867138726, 0.843769010167724, 0.8296037918887957, 0.968829381621142, 0.6970850221298824, 0.5201108314947601, 0.8007544806700523, 0.8137523569231719, 0.9024436629878617, 0.6971879288463989, 0.9845361472367972, 0.901647002078171, 0.7241285989748119, 0.9723354629052642, 0.8610488107352183, 0.678155466027484, 0.98206531876969, 0.6294428001072965, 0.9989279937470825]
    auc_scores_100_2 = [0.49211407340693003, 0.6928662575656958, 0.805272700888702, 0.9488077150036289, 0.9505124273522934, 0.8148483078898717, 0.46846427723271933, 0.9016595249496501, 0.7866207266440957, 0.9325924653359963, 0.5742714165908456, 0.6642386332445995, 0.9993016837687371, 0.6586764392503449, 0.7700484763696042, 0.550144344895779, 0.5070684816623195, 0.9653362035194774, 0.6469609284708951, 0.778133484206336, 0.9158531256581077, 0.7796955942465866, 0.7570612047433263, 0.9768159750546009, 0.6136001465673484, 0.931190558594702, 0.9645685378180915, 0.8923159081116112, 0.7349656422604751, 0.7613015174354004, 0.7569678728482703, 0.8811215597107354, 0.9014471308186196, 0.8775715735416219, 0.9957709354957356, 0.8582375018442414, 0.8635000144341675, 0.697813773916061, 0.7826937198590658, 0.9434847122033134, 0.7725274774426507, 0.8509745716857097, 0.6158509986634987, 0.5744066096661601, 0.742528948336178, 0.5699409820989632, 0.6458156309688536, 0.9431133385315065, 0.7177779494623493, 0.9222319087094937, 0.7252258321519374, 0.9954160913483818, 0.9170659938974165, 0.8318085045725534, 0.9916868097381177, 0.7964302964359956, 0.8957390240275106, 0.8289208353874099, 0.6497525064936416, 0.8471748875966734, 0.798510744764444, 0.6220583230971053, 0.9145049532850739, 0.9798160959190219, 0.6771771394073552, 0.9218432131986876, 0.9264116123387176, 0.7849625564223008, 0.739081861513012, 0.9669098412663075, 0.9980468473868896, 0.7563414799009114, 0.6380230229631378, 0.7672623515722656, 0.7226441236406573, 0.6728684002613381, 0.9995892246717356, 0.5922872264746891, 0.6289816146543636, 0.9643715223356503, 0.8980453671301988, 0.7653408429950754, 0.9216880324834871, 0.9442332581104949, 0.7263212571492975, 0.7889844775858795, 0.9019241608795666, 0.8504271063416606, 0.6767704962161303, 0.7988529539865888, 0.9397473932367004, 0.6798724723097247, 0.9940833293257669, 0.5596243306683271, 0.5582326683132878]
    auc_scores_300_3 = [0.7620744133770186, 0.822961164237459, 0.9607682572768556, 0.7855472507302266, 0.6682496171318997, 0.9364196588697675, 0.8323424114563356, 0.8762205926098371, 0.7826794783316522, 0.9765276134498684, 0.7030618981050015, 0.8835142383986752, 0.979706714782601, 0.7673365163506738, 0.8018659719758012, 0.46827467939158957, 0.9179188293278666, 0.999269154819713, 0.5363784591177041, 0.7581235109226967, 0.5869659694272812, 0.8857464784181959, 0.9180053731015955, 0.9275766723320058, 0.8949346269661933, 0.8739721429770096, 0.9891426211128813, 0.9004856350963824, 0.8736041897379105, 0.7157686604053385, 0.8049260496183206, 0.728352953309858, 0.5112073970236326, 0.971673918426545, 0.9307567892557436, 0.7750353509796596, 0.6932219015552349, 0.4850527501283559, 0.7909402117665791, 0.9234437751004015, 0.8962261107107905, 0.6903684855338799, 0.8474679560156971, 0.7482826655097256, 0.5687610740084503, 0.7081272700467747, 0.649993054845752, 0.9877603123748498, 0.8546015438138725, 0.4737745781620416, 0.702617142385745, 0.7131426539321277, 0.9837687842401117, 0.5842952762544995, 0.5982105533939998, 0.9438131759383614, 0.715285350781534, 0.6645252226941922, 0.9180324903216469, 0.7341400806747341, 0.8429516904139617, 0.681720411896213, 0.7916785471453953, 0.7290945790080738, 0.6310413552566019, 0.802322791865995, 0.7945729798473881, 0.908879078912542, 0.8740337269021019, 0.9973551289139067, 0.8572854291417166, 0.8803904104505307, 0.8260386601853258, 0.8281494420690374, 0.4036836845930232, 0.9554330793030014, 0.9901174464042833, 0.5765939750250662, 0.8269884218474705, 0.8947402167176046, 0.7836603439437013, 0.9470875184505166, 0.8654057313604782, 0.5684059722438796, 0.7833931156449001, 0.513985650410731, 0.8358626041175546, 0.5960663551112625, 0.6207896175708995, 0.8926035884858655, 0.873228185662118, 0.9201127819548873, 0.890998760674329, 0.5838220192411632, 0.684415556693989]
    auc_scores_300_2 = [0.8777585520053766, 0.5970634374865689, 0.6122221798150198, 0.7617669261264505, 0.912281460549965, 0.9084811791027201, 0.49102148954960256, 0.6559953591279478, 0.9151464121994572, 0.7474324910019409, 0.7219852177319097, 0.7840269903732854, 0.9977506765543177, 0.9512527358865196, 0.499045884764688, 0.9022066320337914, 0.9926356662383795, 0.9168115520544221, 0.6784151677199806, 0.8301739261848599, 0.7188031962830193, 0.9641638469920284, 0.9239223682411011, 0.7715004357467665, 0.9644185151942556, 0.7235113187393023, 0.9891721248598572, 0.790960598410666, 0.8501413666772857, 0.8350064375955581, 0.652233520723104, 0.7899860040381792, 0.8179871760380234, 0.969077136940055, 0.9147075763128959, 0.7205735021948942, 0.6893321893321893, 0.8234189898784913, 0.8837722615041403, 0.9554349105461394, 0.9654665542990415, 0.6166642364148927, 0.7847199003009211, 0.37766324446652316, 0.6589811155028547, 0.864466893204381, 0.6695291198723512, 0.8438818565400843, 0.6647342303654927, 0.905538562977344, 0.8883635105524161, 0.8792176915059927, 0.9710146438606827, 0.745688972526807, 0.7256840478523036, 0.8366316863754354, 0.7890349517572752, 0.7782466186941941, 0.9457571665974243, 0.47438055988339944, 0.6656955087271178, 0.5395259903673674, 0.9744115698653535, 0.4733242134062927, 0.9529787162389708, 0.8164415844658002, 0.898101754575005, 0.7960773031210937, 0.8964352754978099, 0.9800467855722911, 0.9146554606522995, 0.8319668268777684, 0.7074013668841256, 0.948033577394374, 0.7418154761904762, 0.8752000519053591, 0.9719163601929133, 0.7711327177480176, 0.7200627736726875, 0.9351851221785965, 0.7388601256153454, 0.4014752199841979, 0.6396104640498901, 0.7830619506755871, 0.6089461507054393, 0.7363895092966931, 0.9644902717015887, 0.7585131639559193, 0.6159898523815652, 0.8449854235348611, 0.9906437436081704, 0.41618848895844207, 0.7628343356146953, 0.7602802876636549, 0.5780333351609189]
    auc_scores_300 = [0.8063687182978396, 0.6932904670846635, 0.951598855294264, 0.7936884087779229, 0.8193670333931082, 0.9450152207001522, 0.7512827525134136, 0.8498165678955334, 0.7219027170717991, 0.9152498363024677, 0.7469066811172075, 0.9790604302209718, 0.9996296357261609, 0.7633859995611147, 0.9596939696376168, 0.7842960325826152, 0.9983971757831521, 0.9237182354723733, 0.709463920248234, 0.8460126543182641, 0.7615176585428303, 0.931524864978607, 0.9463729673624726, 0.8651198183399362, 0.8526093088857546, 0.9664623151821132, 0.9075321952680444, 0.8390072445972494, 0.9125529523644852, 0.9500272226996819, 0.9623953349282296, 0.794442052267232, 0.5506293218157625, 0.8647095735270769, 0.8275428896955178, 0.5985383064516129, 0.6865675199008533, 0.6486322899606318, 0.9237184943490802, 0.9425794141914192, 0.9624409509796329, 0.2430321735877291, 0.9610636825103831, 0.5839059315767643, 0.7033832582036741, 0.8305803879778186, 0.5689490286758304, 0.9345671908963049, 0.6277951569922373, 0.7096633857197236, 0.8833159177986765, 0.9155322345656529, 0.8937798318054397, 0.8611756181290128, 0.7920427987550258, 0.9220514841082217, 0.7493790136919909, 0.9020119225037257, 0.9132637419908642, 0.7680722891566267, 0.6192818669140766, 0.502722619152827, 0.9375796046432159, 0.8869459548525291, 0.7469576065720407, 0.9610003642504719, 0.5946391107512239, 0.826313003365221, 0.9006088261637899, 0.820022375100187, 0.9577353912863926, 0.8396995575358148, 0.6601458885941645, 0.950659039266339, 0.7409316283924844, 0.8343472398732993, 0.9996149683649683, 0.4892348064650802, 0.9193997133462608, 0.97137847963444, 0.7391254904190595, 0.9253151337041264, 0.9806500596868197, 0.4794145079000358, 0.9478558668324127, 0.9180246676891615, 0.8267326732673268, 0.6877098985803476, 0.8176202573026132, 0.8406254159712481, 0.968010077762667, 0.8268282707697749, 0.9038869683178714, 0.788963151357426, 0.6399913718723036]
    auc_scores_300_4 = [0.8669820844696912, 0.9090391385379997, 0.557603023953326, 0.8629706125958, 0.7264908385836512, 0.8570677381080789, 0.648081173397629, 0.7003633461937743, 0.7089678510998307, 0.9450224708893769, 0.47939606272939606, 0.8803630930545365, 0.9493562607789428, 0.8074970131421744, 0.42792886116805506, 0.8658212840537127, 0.9615180766368209, 0.5606296141825686, 0.5240552286588093, 0.8347801719148832, 0.7355497824944195, 0.7732784875947111, 0.9448809249221544, 0.9217852943210901, 0.7326304203343548, 0.9851881744537111, 0.9836993276842901, 0.9672187749226789, 0.945001599122767, 0.6686898481668463, 0.898309790334044, 0.6742738344837333, 0.7022771526958456, 0.6139911394329013, 0.7198285493733114, 0.8037478590607541, 0.9664335481167163, 0.8525865289901836, 0.8547674638732884, 0.750310649323181, 0.9319816553319091, 0.6575105028480116, 0.733471885038868, 0.77032872570075, 0.5092271631837839, 0.6833860968209997, 0.2913995491935248, 0.9650438929686841, 0.5629014705101663, 0.9092840528214802, 0.9058826410658306, 0.9692673149729047, 0.8265690824178662, 0.532723801748151, 0.6189935096200143, 0.7076936888410091, 0.8315629980706316, 0.7849643047011469, 0.8116601426804263, 0.5343262471236463, 0.6696200510855683, 0.5412469171926597, 0.8396012715655358, 0.9466924983714181, 0.7063936173547759, 0.7283702355248861, 0.9047090463454791, 0.9385360582916986, 0.5640170204311401, 0.9819445142483791, 0.9988412173687988, 0.9135500618793202, 0.8542863984674329, 0.8379323358344803, 0.4641980888429752, 0.9091871263956592, 0.5521377529574251, 0.666065867235587, 0.7555675287356322, 0.7987081902804091, 0.8134212957384422, 0.7602261290040259, 0.723237615314883, 0.9711972718055853, 0.9153671855679061, 0.9392532368645148, 0.9885497858296468, 0.7132001019531582, 0.7768192262717616, 0.7637312207139753, 0.9798707143441616, 0.871061249778722, 0.9419085895505271, 0.6154732064223292, 0.6358701008574527]
    eer_scores_300_4 = [0.22807017543859648, 0.18801652892561985, 0.4918032786885246, 0.2445141065830721, 0.2849083215796897, 0.2637795275590551, 0.4074074074074074, 0.39603960396039606, 0.3629441624365482, 0.06609808102345416, 0.5396825396825397, 0.16594827586206898, 0.1347517730496454, 0.25617283950617287, 0.5816831683168316, 0.20987654320987653, 0.0774487471526196, 0.44126074498567336, 0.4983277591973244, 0.2459016393442623, 0.28018223234624146, 0.29133858267716534, 0.13577586206896552, 0.13524590163934427, 0.31343283582089554, 0.05291005291005291, 0.02756892230576441, 0.09405940594059406, 0.1237721021611002, 0.37158469945355194, 0.15565031982942432, 0.36363636363636365, 0.3565365025466893, 0.412573673870334, 0.3460837887067395, 0.2599118942731278, 0.06435643564356436, 0.24293785310734464, 0.1605351170568562, 0.2614213197969543, 0.12944162436548223, 0.4091858037578288, 0.3285024154589372, 0.2928679817905918, 0.5079726651480638, 0.3157894736842105, 0.6638418079096046, 0.08635097493036212, 0.451505016722408, 0.16905071521456436, 0.15364583333333334, 0.11847672778561354, 0.22145328719723184, 0.5107758620689655, 0.44854881266490765, 0.3059071729957806, 0.23901098901098902, 0.2996031746031746, 0.2320675105485232, 0.47547974413646055, 0.43386243386243384, 0.5124113475177305, 0.22323462414578588, 0.1198044009779951, 0.3317972350230415, 0.339662447257384, 0.19438877755511022, 0.10368663594470046, 0.4280936454849498, 0.05198019801980198, 0.0, 0.17114914425427874, 0.25308641975308643, 0.26485148514851486, 0.5041322314049587, 0.15254237288135594, 0.44990892531876137, 0.3680203045685279, 0.3072916666666667, 0.2845691382765531, 0.26252158894645944, 0.3232758620689655, 0.3132832080200501, 0.06691449814126393, 0.12852664576802508, 0.12158054711246201, 0.04964539007092199, 0.3667953667953668, 0.3010033444816054, 0.33537832310838445, 0.0891089108910891, 0.1970260223048327, 0.09823182711198428, 0.4302554027504912, 0.43687374749499]
    auc_scores_500_2 = [0.7550810393619758, 0.7059073432886547, 0.9010649165278963, 0.6713927952225006, 0.9036338258651393, 0.8962724692526016, 0.713746068644879, 0.9521119135150239, 0.8172789202266505, 0.794644846624248, 0.6866961521450685, 0.9306488817570955, 0.9257340409048652, 0.6582656473960822, 0.7275719911395521, 0.906974480758375, 0.944127328757529, 0.9500315457413249, 0.7851530612244898, 0.7664284786280369, 0.9122422732205298, 0.8273282650013576, 0.9750163060431614, 0.8417819693491345, 0.8492480818414322, 0.7691334499562664, 0.9800061735323831, 0.6900111141983883, 0.8256226255804137, 0.9969023978759299, 0.7526828558964666, 0.8867592993079585, 0.6667886022333462, 0.9094109042147929, 0.9644373826375848, 0.7033200184906422, 0.5997662381031892, 0.6445833939217682, 0.9307139283174888, 0.8465386238919375, 0.9545797820692632, 0.6859246791500104, 0.8442730813769871, 0.865783099069631, 0.7565945625202287, 0.8001707796089147, 0.7863016999869464, 0.8396299902629016, 0.618946053592892, 0.9278671180702497, 0.8792484547094154, 0.6338530579368276, 0.9723294529223716, 0.8572746492408228, 0.723939191446709, 0.25702783126203393, 0.6528662420382165, 0.8040670391061453, 0.8993721584758606, 0.7095921961793795, 0.9892238751371785, 0.8491474313284719, 0.4950922784076802, 0.8749147309086992, 0.48445913842255306, 0.9260013256320423, 0.8509316770186335, 0.8645429022046733, 0.9239702745934417, 0.9426408275174476, 0.9290909090909092, 0.8681166708574302, 0.7121141796240427, 0.8890109164175654, 0.5884128324187421, 0.5791596069129109, 0.8781829829096982, 0.7917064325252909, 0.8549494898854435, 0.9920446866975989, 0.8539164061214416, 0.876985883081825, 0.9619788083115453, 0.7288220051823799, 0.6923669683638299, 0.6870936373863138, 0.9046090273363, 0.8706173682862266, 0.8548818088386434, 0.9457334163811897, 0.9585682443949128, 0.7816394639411796, 0.9448784082535003, 0.6829686904060192, 0.8665795791554867]
    eer_scores_500_2 = [0.3110367892976589, 0.35195530726256985, 0.16722408026755853, 0.3413793103448276, 0.19240506329113924, 0.15562913907284767, 0.28640776699029125, 0.11371237458193979, 0.2805755395683453, 0.27514792899408286, 0.4541176470588235, 0.16101694915254236, 0.15625, 0.40372670807453415, 0.32217573221757323, 0.13966480446927373, 0.1059322033898305, 0.13, 0.30857142857142855, 0.2930232558139535, 0.1510791366906475, 0.2620689655172414, 0.07106598984771574, 0.23788546255506607, 0.2565217391304348, 0.304635761589404, 0.046610169491525424, 0.3728813559322034, 0.21304347826086956, 0.03349282296650718, 0.34448160535117056, 0.20588235294117646, 0.44081632653061226, 0.16560509554140126, 0.07906976744186046, 0.34309623430962344, 0.42924528301886794, 0.3565217391304348, 0.16722408026755853, 0.21359223300970873, 0.08361204013377926, 0.3836734693877551, 0.2236024844720497, 0.19796954314720813, 0.3177257525083612, 0.2938775510204082, 0.2508710801393728, 0.2653846153846154, 0.40569395017793597, 0.1510791366906475, 0.23411371237458195, 0.4031413612565445, 0.05508474576271186, 0.24793388429752067, 0.3424657534246575, 0.7172413793103448, 0.4406779661016949, 0.2849162011173184, 0.14193548387096774, 0.3377049180327869, 0.059322033898305086, 0.24749163879598662, 0.4875444839857651, 0.19875776397515527, 0.49477351916376305, 0.13135593220338984, 0.22440944881889763, 0.24414715719063546, 0.16129032258064516, 0.15073529411764705, 0.1291866028708134, 0.24390243902439024, 0.35080645161290325, 0.2052980132450331, 0.44660194174757284, 0.4153846153846154, 0.17955112219451372, 0.3106508875739645, 0.21951219512195122, 0.03914590747330961, 0.2033898305084746, 0.23237597911227154, 0.08837209302325581, 0.34104046242774566, 0.41338582677165353, 0.39664804469273746, 0.1576923076923077, 0.21338912133891214, 0.2014388489208633, 0.14201183431952663, 0.10646387832699619, 0.2677165354330709, 0.06956521739130435, 0.44039735099337746, 0.20103092783505155]
    auc_scores_500 = [0.49658714592305175, 0.9839197303783763, 0.7206888529340227, 0.5714152996761692, 0.6558421014571356, 0.9052251380784473, 0.5809137994025488, 0.6060291004001711, 0.7622748322181214, 0.9060284400841676, 0.9431362800928018, 0.7149679707160833, 0.9552561420600093, 0.8057841416136347, 0.7944013041638667, 0.7873092805312095, 0.9383056230151318, 0.7725695000694199, 0.22902545025307175, 0.8451161080670794, 0.49824386751826044, 0.760346711438013, 0.7831896619404274, 0.8620233941735628, 0.7818192653807188, 0.9472194017027259, 0.9996305997716436, 0.8441056758929978, 0.9167282414249047, 0.4933570542534439, 0.7082989170337739, 0.9568109915259942, 0.8394459875668423, 0.9508828312553241, 0.957278708792372, 0.7703573961445058]
    auc_scores_1000 = [0.799362698099374, 0.814792855554732, 0.9243697478991597, 0.7675204722909922, 0.7152151283830674, 0.6645292207792208, 0.8291620224946803, 0.8120191213293877, 0.43704600484261497, 0.9232542574551945, 0.5197556390977444, 0.46449704142011833, 0.8000959079283887, 0.7152549697493518, 0.5684984520123839, 0.4495629370629371, 0.7913830821584833, 0.8401898734177214, 0.5443501170960187, 0.6460674157303371, 0.5476208430736746, 0.8192350956130484, 0.8296419044539649, 0.8191748918709106, 0.9066597377678287, 0.5, 0.7780906853464595, 0.6438345692225365, 0.5492303831353521, 0.8215348701488183, 0.3493421052631579, 0.5427726255196674, 0.8353196099674973, 0.3830578512396694, 0.8314772727272726, 0.6358082706766917, 0.5045871559633027, 0.8500628597895852, 0.8080091533180778, 0.8549407114624505, 0.612484112413501, 0.5288523741751844, 0.6627197958026092, 0.6557603686635944, 0.8337464482195757, 0.5150629037742265, 0.7143529657914007, 0.38208553148501523, 0.8117647058823529, 0.8111176818450622, 0.6823456916914861, 0.7116026105873823, 0.47706876276536486, 0.3637112722478576, 0.5942534908700322, 0.5804752572268497, 0.7347826086956522, 0.8252457002457003, 0.6476457155284907, 0.7040663121676571, 0.4400154798761611, 0.48179025888547605, 0.44049043062200954, 0.6742381375798238, 0.534053738317757, 0.7971476510067114, 0.8177003931637645, 0.8540975013105014, 0.7566371681415929, 0.8381321295674982, 0.6087323244852394, 0.43097122302158275, 0.3828197551709582, 0.7045889973542558, 0.7832798165137614, 0.8981701326346815, 0.5409815005138746, 0.6237113402061856, 0.5509184885101628, 0.6343553608836412, 0.5192911484120275, 0.5478211443728684, 0.7958826205641493, 0.6538797462535626, 0.9958677685950413, 0.6677683765203596, 0.7241441658630665, 0.6122898870212179, 0.6896551724137931, 0.6638402939937985, 0.8903693543646516, 0.7742105263157895, 0.6260157882516834, 0.5655754795663053]
    auc_scores_1500 = [0.43521421107628, 0.6696708463949843, 0.5035161744022504, 0.6634154141349536, 0.6114594218042494, 0.8477011494252873, 0.49261229314420807, 0.6074336046977178, 0.6902286902286903, 0.871052295102928, 0.5479583975346687, 0.5238933601609659, 0.6976470588235294, 0.5, 0.5283333333333333, 0.5097398669086509, 0.6859110169491526, 0.8755952380952381, 0.5547884841363102, 0.5785593220338983, 0.7349503214494448, 0.6484725965858041, 0.8273305084745763, 0.48404255319148937, 0.5341312056737588, 0.81875, 0.6372482075793786, 0.9505770662695457, 0.7105263157894738, 0.9090909090909091, 0.8354700854700855, 0.5310267857142856, 0.782389108476065, 0.5968053173241852, 0.7357459699231852, 0.695053544110148, 0.6759486759486759, 0.7681704260651628, 0.646671826625387, 0.89894419306184, 0.5, 0.8134057971014493, 0.7185452162516381, 0.6671593988667158, 0.7835634829305715, 0.4786059351276743, 0.8775083612040134, 0.6326811594202899, 0.8650210084033614, 0.8692002442002442, 0.4258064516129032, 0.8749615975422428, 0.48241933872739984, 0.44742623979912116, 0.8920174165457185, 0.7003407984420642, 0.8356368563685637, 0.7139668367346939, 0.6188172043010752, 0.5496833276275248, 0.5236209335219236, 0.7645774647887322, 0.6995614035087719, 0.6899245689655172, 0.6328125, 0.5045543266102798, 0.9080163335482484, 0.6612499999999999, 0.7842334969994544, 0.7511655011655012, 0.5033482142857143, 0.6075514874141876, 0.8811090225563909, 0.4299812030075188, 0.506551724137931, 0.6183760683760684, 0.631559497413156, 0.482117812061711, 0.925373727735369, 0.753945480631277, 0.7808903694730467, 0.8339285714285715, 0.4866615853658536, 0.5144256361119983, 0.8034656722965562, 0.5721590909090909, 0.725925925925926, 0.6342375239088853, 0.5597435897435897, 0.6034226190476191, 0.6963559322033898, 0.5508474576271186, 0.71131709681328, 0.7870833333333332, 0.7387387387387386]
    auc_scores_1500_2 = [0.7492314448836188, 0.8160919540229885, 0.861895488477767, 0.7856004635665652, 0.6058797524314765, 0.9155890804597702, 0.7446808510638298, 0.8495424558416684, 0.8047435190292332, 0.9127988748241913, 0.6431541019955654, 0.7009557344064385, 0.8610251117991056, 0.8253229974160207, 0.8063856960408684, 0.6018947368421053, 0.903960396039604, 0.7046277665995976, 0.4310247747747748, 0.7750385208012327, 0.6363927086664534, 0.8349673202614378, 0.5390307949391263, 0.7575201760821717, 0.4132540227255395, 0.8218487394957983, 0.5813829787234043, 0.6280614903595623, 0.9051724137931035, 0.8960526315789473, 0.49365601503759393, 0.9350282485875706, 0.7467532467532467, 0.8564600678384212, 0.6875822729267222, 0.7360289283366206, 0.6486486486486487, 0.7995169082125604, 0.8397855325336241, 0.559795321637427, 0.7393483709273183, 0.6110641891891893, 0.9680298604349237, 0.6712940608401737, 0.42946605141727096, 0.95086891225059, 0.5713509316770187, 0.6820652173913044, 0.7724390243902439, 0.8695578231292517, 0.8644986449864499, 0.7859649122807018, 0.9788204626914304, 0.80978942964719, 0.6272882077479778, 0.614835164835165, 0.7101841820151679, 0.8321224701608719, 0.9413994169096209, 0.7062499999999999, 0.9460403726708075, 0.46262149150694887, 0.5464213854555907, 0.6512204424103737, 0.7362818590704647, 0.9528601694915254, 0.8524528301886792, 0.9009284766860525, 0.91875, 0.8940050559768871, 0.7894736842105263, 0.8994654605263158, 0.7393892339544514, 0.7249904422072129, 0.4681088314005353, 0.799426523297491, 0.9117867867867868, 0.6783536585365854, 0.9085841694537345, 0.9350498123948764, 0.8237786640079761, 0.5879378837125316, 0.8972619047619047, 0.5768546747967479, 0.8108198924731185, 0.9094033114651672, 0.8345744680851065, 0.7716049382716048, 0.45525699991930924, 0.5469724770642201, 0.9331140350877194, 0.8354716981132075, 0.9315514993481095, 0.7486772486772486, 0.9199999999999999]
    eer_scores_1500_2 = [0.34782608695652173, 0.26595744680851063, 0.19230769230769232, 0.3162393162393162, 0.4423076923076923, 0.16666666666666666, 0.288135593220339, 0.2702702702702703, 0.24489795918367346, 0.18518518518518517, 0.43902439024390244, 0.3380281690140845, 0.21052631578947367, 0.16666666666666666, 0.25287356321839083, 0.39, 0.16831683168316833, 0.323943661971831, 0.6041666666666666, 0.2878787878787879, 0.4339622641509434, 0.21568627450980393, 0.49295774647887325, 0.29310344827586204, 0.5698924731182796, 0.20588235294117646, 0.425531914893617, 0.3815789473684211, 0.09195402298850575, 0.1125, 0.5535714285714286, 0.11864406779661017, 0.2727272727272727, 0.09574468085106383, 0.313953488372093, 0.3717948717948718, 0.40625, 0.21739130434782608, 0.1984732824427481, 0.45555555555555555, 0.3308270676691729, 0.43243243243243246, 0.05063291139240506, 0.3684210526315789, 0.5405405405405406, 0.1016949152542373, 0.45535714285714285, 0.3695652173913043, 0.3048780487804878, 0.1523809523809524, 0.14634146341463414, 0.25, 0.0707070707070707, 0.2871287128712871, 0.367816091954023, 0.42857142857142855, 0.36619718309859156, 0.2765957446808511, 0.14285714285714285, 0.32608695652173914, 0.125, 0.5321100917431193, 0.4897959183673469, 0.40217391304347827, 0.34782608695652173, 0.125, 0.25, 0.18181818181818182, 0.17105263157894737, 0.16901408450704225, 0.3157894736842105, 0.21052631578947367, 0.3333333333333333, 0.3389830508474576, 0.4915254237288136, 0.3118279569892473, 0.16216216216216217, 0.375, 0.15384615384615385, 0.2033898305084746, 0.23728813559322035, 0.4084507042253521, 0.17333333333333334, 0.4634146341463415, 0.25, 0.16161616161616163, 0.2624113475177305, 0.2826086956521739, 0.5032679738562091, 0.4954128440366973, 0.12280701754385964, 0.2641509433962264, 0.13559322033898305, 0.34615384615384615, 0.12]
    auc_scores_300min = [0.779445308337466, 0.43866080928752776, 0.917994107031197, 0.7592139449768106, 0.5232929150046208, 0.8153018653394156, 0.6282984581766067, 0.7486726599974218, 0.8654251225341272, 0.8787190626645602, 0.7641275838350456, 0.710960345580144, 0.9745565861460012, 0.4751752439731295, 0.9248428392899586, 0.89954130229254, 0.9830754959020533, 0.8894061704241286, 0.6921064678569093, 0.7665536299494131, 0.6631521100860724, 0.6943869727409003, 0.7540999527364312, 0.7456622320254619, 0.974605984189546, 0.7488716547624695, 0.9781562123660381, 0.9096369685021731, 0.960895788718633, 0.7789902488008994, 0.6958514986591694, 0.8988800631529507, 0.9279997144748957, 0.8811763752554125, 0.8741623022712792, 0.7343111772591187, 0.9290679593890057, 0.7128869568361971, 0.7879345137823756, 0.4806411481801769, 0.8640310697650413, 0.40164603226529216, 0.8268770629150226, 0.6373557398082402, 0.9255027228774637, 0.872526141107808, 0.6272146476417375, 0.6210414762756733, 0.8407429862092411, 0.5663122566143504, 0.8974912435724095, 0.9439300889478143, 0.9858215177337206, 0.7382138812263115, 0.6999365091539738, 0.9358255383890334, 0.7496751881816055, 0.7629336741247652, 0.8852064642496891, 0.7466882409813351, 0.7519361994353546, 0.8544071527883941, 0.5358460701666566, 0.7282937937746381, 0.9317450130739406, 0.9409621383651632, 0.9736188899442316, 0.7377846984349273, 0.8747950882676788, 0.8449344332358707, 0.9760272937418167, 0.8662797892711385, 0.5588952857076656, 0.6074000487611395, 0.5895688420928575, 0.6314465996540344, 0.8904551483436922, 0.8176207229995137, 0.8245852010153889, 0.7686923126634633, 0.8762461288765709, 0.7333713403901815, 0.6693917409143866, 0.7617602798247601, 0.8999858502812923, 0.7841534293400636, 0.9722307580180671, 0.7767153245959124, 0.7421820896107459, 0.7720640025930152, 0.961530635114978, 0.7879039799790742, 0.9530744138954167, 0.6090518160494706, 0.5560834783186257]
    eer_scores_300min = [0.2440347071583514, 0.5041876046901173, 0.14461045891141944, 0.28937007874015747, 0.45409565695437054, 0.2377994676131322, 0.41379310344827586, 0.3149946062567422, 0.22064244339125855, 0.22643496577145866, 0.29545454545454547, 0.35411855273287146, 0.06773399014778325, 0.5394300861497681, 0.13925729442970822, 0.15694164989939638, 0.04864532019704434, 0.20012430080795526, 0.392583872866392, 0.3497536945812808, 0.3584905660377358, 0.3554476806903991, 0.33733239237826396, 0.3333333333333333, 0.05818463925523662, 0.3068526379624015, 0.05887300252312868, 0.13005050505050506, 0.10384068278805121, 0.2759538598047915, 0.3618817852834741, 0.20273738237810093, 0.16029334730225248, 0.18196811434854315, 0.17726991970352068, 0.3540790580319596, 0.14080459770114942, 0.3493975903614458, 0.2666256157635468, 0.5397398843930635, 0.23347483323226198, 0.5940803382663847, 0.23346523459581683, 0.3985938345051379, 0.17331670822942644, 0.1874670879410216, 0.4089496581727781, 0.41993281075027994, 0.2364402317008952, 0.4119922630560928, 0.15727502102607233, 0.11008676789587853, 0.05869275233437083, 0.3253493013972056, 0.3375870069605568, 0.12922297297297297, 0.3151635282457879, 0.3293709757305597, 0.20424403183023873, 0.3256681168427595, 0.3458961474036851, 0.21188934667451442, 0.4647887323943662, 0.30258014073494915, 0.15854738706820196, 0.13583990297149787, 0.09015345268542199, 0.35102201257861637, 0.21882700837851157, 0.23342175066312998, 0.08583464981569247, 0.25728987993138935, 0.4807593637762955, 0.41405849153412005, 0.4573074908328968, 0.4336618650492798, 0.13822525597269625, 0.24697885196374622, 0.23958896700919416, 0.2892768079800499, 0.1351250466592012, 0.3361261705273534, 0.40189873417721517, 0.2933597621407334, 0.1282051282051282, 0.28378378378378377, 0.07793575566087414, 0.30905636478784043, 0.34350132625994695, 0.2916666666666667, 0.09030271934325294, 0.27236580516898606, 0.09274563820018365, 0.4230769230769231, 0.42730102267674525]
    print("Mean eer 100_3: ", np.mean(eer_100))
    print("Mean auc 100_3: ", np.mean(auc_scores_100_3))
    print("Mean auc_100: ", np.mean(auc_scores_100))
    print("Mean auc_100_2: ", np.mean(auc_scores_100_2))
    print("Mean auc 300: ", np.mean(auc_scores_300))
    print("Mean auc 300_2: ", np.mean(auc_scores_300_2))
    print("Mean auc 300_3: ", np.mean(auc_scores_300_3))
    print("Mean auc 300_4: ", np.mean(auc_scores_300_4))
    print("Mean eer 300_4: ", np.mean(eer_scores_300_4))
    print("Mean eer 100_3: ", np.mean(eer_100))
    print("Mean auc 100_3: ", np.mean(auc_scores_100_3))
    print("Mean auc 500: ", np.mean(auc_scores_500))
    print("Mean eer 500_2: ", np.mean(eer_scores_500_2))
    print("Mean auc 500_2: ", np.mean(auc_scores_500_2))
    print("Mean auc 1000: ", np.mean(auc_scores_1000))
    print("Mean auc 1500: ", np.mean(auc_scores_1500))
    print("Mean auc 1500_2: ", np.mean(auc_scores_1500_2))
    print("Mean eer 1500: ", np.mean(eer_scores_1500_2))
    print("Mean auc 300min: ", np.mean(auc_scores_300min))
    print("Mean eer 300min: ", np.mean(eer_scores_300min))


#validate_model()
evaluate_performance()